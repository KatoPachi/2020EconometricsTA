% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  12pt,
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Econometrics II TA Session \#5},
  pdfauthor={Hiroki Kato},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{zxjatype}
\setCJKmainfont[BoldFont = IPAゴシック]{IPA明朝}
\setCJKsansfont{IPAゴシック}
\setCJKmonofont{IPAゴシック}
\parindent = 1em
\newcommand{\argmax}{\mathop{\rm arg~max}\limits}
\newcommand{\argmin}{\mathop{\rm arg~min}\limits}
\DeclareMathOperator*{\plim}{plim}
\usepackage{xcolor}
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{Econometrics II TA Session \#5}
\author{Hiroki Kato}
\date{}

\begin{document}
\maketitle

\hypertarget{empirical-application-of-truncated-regression-labor-participation-of-married-women-1}{%
\section{Empirical Application of Truncated Regression: Labor
Participation of Married Women
(1)}\label{empirical-application-of-truncated-regression-labor-participation-of-married-women-1}}

\hypertarget{background-and-data}{%
\subsection{Background and Data}\label{background-and-data}}

To develop women's social advancement, we should create environment to
keep a good balance between work and childcare after marriage. In this
application, using the dataset of married women, we explore how much
childcare prevents married women to participate in labor market.

Our dataset originally comes from Stata sample data. \footnote{\url{http://www.stata-press.com/data/r13/laborsub.dt}.
  Because this is dta file, we need to import it, using the
  \texttt{read.dta} function in the library \texttt{foreign}. I
  intentionally remove married women who could not participate in the
  labor market.} This dataset contains the following variables:

\begin{itemize}
\tightlist
\item
  \texttt{whrs}: Hours of work. This outcome variable is truncated from
  below at zero.
\item
  \texttt{kl6}: the number of preschool children
\item
  \texttt{k618}: The number of school‐aged children
\item
  \texttt{wa}: age
\item
  \texttt{we}: The number of years of education
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dt \textless{}{-}}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\DataTypeTok{file =} \StringTok{"./data/labor.csv"}\NormalTok{, }\DataTypeTok{header =} \OtherTok{TRUE}\NormalTok{,  }\DataTypeTok{sep =} \StringTok{","}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(dt)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       whrs           kl6              k618             wa       
##  Min.   :  12   Min.   :0.0000   Min.   :0.000   Min.   :30.00  
##  1st Qu.: 645   1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:35.00  
##  Median :1406   Median :0.0000   Median :1.000   Median :43.50  
##  Mean   :1333   Mean   :0.1733   Mean   :1.313   Mean   :42.79  
##  3rd Qu.:1903   3rd Qu.:0.0000   3rd Qu.:2.000   3rd Qu.:48.75  
##  Max.   :4950   Max.   :2.0000   Max.   :8.000   Max.   :60.00  
##        we       
##  Min.   : 6.00  
##  1st Qu.:12.00  
##  Median :12.00  
##  Mean   :12.64  
##  3rd Qu.:13.75  
##  Max.   :17.00
\end{verbatim}

\hypertarget{model}{%
\subsection{Model}\label{model}}

Since we cannot observe those who could not partiapte in the labor
market (\texttt{whrs\ =\ 0}), we use the truncated regression model.
Thus, the selection rule is as follows:

\begin{equation*}
  \begin{cases}
    y_i = x_i \beta + u_i &\text{if}\:\: s_i = 1  \\
    s_i = 1 &\text{if}\:\: a_1 < y_i < a_2
  \end{cases}.
\end{equation*} where \(u_i \sim N(0, \sigma^2)\). In this case,
\(a_1 = 0\) and \(a_2 = +\infty\).

Since we are interested in estimating \(\beta\), we must condition on
\(s_i = 1\). The probability density function of \(y_i\) conditional on
\((x_i, s_i = 1)\) is

\begin{equation*}
  p_{\theta}(y_i | x_i, s_i = 1) = \frac{f(y_i | x_i)}{\int_0^{+\infty} f(y_i | x_i) dy_i}.
\end{equation*} where \(\theta = (\beta, \sigma^2)'\). Because the
distribution of \(y_i\) depends on the distribution of \(u_i\), using
\(u_i = y_i - x_i \beta\), we obtain

\begin{equation*}
  p_{\theta}(u_i | x_i, -x_i \beta < u_i) 
  = \frac{1}{\sigma} \frac{\phi(\frac{y_i - x_i \beta}{\sigma})}{1 - \Phi(\frac{- x_i \beta}{\sigma})}.
\end{equation*} Thus, the log-likelihood function is

\begin{equation*}
  M_n(\theta) 
  = \sum_{i=1}^n \log \left( \frac{1}{\sigma} \frac{\phi(\frac{y_i - x_i \beta}{\sigma})}{1 - \Phi(\frac{- x_i \beta}{\sigma})} \right).
\end{equation*}

We provide two ways to estimate truncated regression, using \texttt{R}.
First way is to define the log-likelihood function directly and minimize
its function by \texttt{nlm} function. Recall that \texttt{nlm} function
provides the Newton method to minimize the function. We need to give
intial values in argument of this function. Coefficients of explanatory
variables, \texttt{b{[}3:6{]}}, are zero, and intercept,
\texttt{b{[}2{]}}, and \(\sigma\), \texttt{b{[}1{]}}, are given by mean
and standard deviation of \texttt{whrs}, respectively.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{whrs \textless{}{-}}\StringTok{ }\NormalTok{dt}\OperatorTok{$}\NormalTok{whrs}
\NormalTok{kl6 \textless{}{-}}\StringTok{ }\NormalTok{dt}\OperatorTok{$}\NormalTok{kl6; k618 \textless{}{-}}\StringTok{ }\NormalTok{dt}\OperatorTok{$}\NormalTok{k618}
\NormalTok{wa \textless{}{-}}\StringTok{ }\NormalTok{dt}\OperatorTok{$}\NormalTok{wa; we \textless{}{-}}\StringTok{ }\NormalTok{dt}\OperatorTok{$}\NormalTok{we}

\NormalTok{LnLik \textless{}{-}}\StringTok{ }\ControlFlowTok{function}\NormalTok{(b) \{}
\NormalTok{  sigma \textless{}{-}}\StringTok{ }\NormalTok{b[}\DecValTok{1}\NormalTok{]}
\NormalTok{  xb \textless{}{-}}\StringTok{ }\NormalTok{b[}\DecValTok{2}\NormalTok{] }\OperatorTok{+}\StringTok{ }\NormalTok{b[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{kl6 }\OperatorTok{+}\StringTok{ }\NormalTok{b[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{k618 }\OperatorTok{+}\StringTok{ }\NormalTok{b[}\DecValTok{5}\NormalTok{]}\OperatorTok{*}\NormalTok{wa }\OperatorTok{+}\StringTok{ }\NormalTok{b[}\DecValTok{6}\NormalTok{]}\OperatorTok{*}\NormalTok{we}
\NormalTok{  condp \textless{}{-}}\StringTok{ }\KeywordTok{dnorm}\NormalTok{((whrs }\OperatorTok{{-}}\StringTok{ }\NormalTok{xb)}\OperatorTok{/}\NormalTok{sigma)}\OperatorTok{/}\NormalTok{(}\DecValTok{1} \OperatorTok{{-}}\StringTok{ }\KeywordTok{pnorm}\NormalTok{(}\OperatorTok{{-}}\NormalTok{xb}\OperatorTok{/}\NormalTok{sigma))}
\NormalTok{  LL\_i \textless{}{-}}\StringTok{ }\KeywordTok{log}\NormalTok{(condp}\OperatorTok{/}\NormalTok{sigma)}
\NormalTok{  LL \textless{}{-}}\StringTok{ }\OperatorTok{{-}}\KeywordTok{sum}\NormalTok{(LL\_i)}
  \KeywordTok{return}\NormalTok{(LL)}
\NormalTok{\}}

\NormalTok{init \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{sd}\NormalTok{(whrs), }\KeywordTok{mean}\NormalTok{(whrs), }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\NormalTok{est.LnLik \textless{}{-}}\StringTok{ }\KeywordTok{nlm}\NormalTok{(LnLik, init, }\DataTypeTok{hessian =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Second way is to use the function \texttt{truncreg} in the library
\texttt{truncreg}. This function must specify the trucated point in
arguments \texttt{point} and \texttt{direction}. If
\texttt{direction\ =\ "left"}, the outcome variable is truncated from
below at \texttt{point}, that is, \texttt{point\ \textless{}\ y}. On the
other hand, if \texttt{direction\ =\ "right"}, the outcome variable is
truncated from above at \texttt{point}, that is,
\texttt{y\ \textless{}\ point}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(truncreg)}
\NormalTok{model \textless{}{-}}\StringTok{ }\NormalTok{whrs }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{kl6 }\OperatorTok{+}\StringTok{ }\NormalTok{k618 }\OperatorTok{+}\StringTok{ }\NormalTok{wa }\OperatorTok{+}\StringTok{ }\NormalTok{we}
\NormalTok{est.trunc \textless{}{-}}\StringTok{ }\KeywordTok{truncreg}\NormalTok{(model, }\DataTypeTok{data =}\NormalTok{ dt, }\DataTypeTok{point =} \DecValTok{0}\NormalTok{, }\DataTypeTok{direction =} \StringTok{"left"}\NormalTok{)}
\NormalTok{se.trunc \textless{}{-}}\StringTok{ }\KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\KeywordTok{vcov}\NormalTok{(est.trunc)))}
\end{Highlighting}
\end{Shaded}

\hypertarget{interpretations}{%
\subsection{Interpretations}\label{interpretations}}

Table \ref{lfp} shows results of truncated regression estimated by two
methods. As a comparison, we also show the OLS result in column (3). All
specifications show that the number of preschool and school-aged
children reduces the hours of work. The size of coefficient of the
number of preschool and school-aged children become stronger when we
apply the truncated regression. Although the relationship between labor
participation and women's characteristics is statistically
insignificant, size of coefficients largely differs among three
specifications.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ols \textless{}{-}}\StringTok{ }\KeywordTok{lm}\NormalTok{(model, }\DataTypeTok{data =}\NormalTok{ dt)}
\NormalTok{coef.LnLik \textless{}{-}}\StringTok{ }\NormalTok{est.LnLik}\OperatorTok{$}\NormalTok{estimate}
\NormalTok{se.LnLik \textless{}{-}}\StringTok{ }\KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\KeywordTok{solve}\NormalTok{(est.LnLik}\OperatorTok{$}\NormalTok{hessian)))}
\KeywordTok{names}\NormalTok{(coef.LnLik) \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"sigma"}\NormalTok{, }\KeywordTok{names}\NormalTok{(}\KeywordTok{coef}\NormalTok{(ols)))}
\KeywordTok{names}\NormalTok{(se.LnLik) \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"sigma"}\NormalTok{, }\KeywordTok{names}\NormalTok{(}\KeywordTok{coef}\NormalTok{(ols)))}

\KeywordTok{library}\NormalTok{(stargazer)}
\KeywordTok{stargazer}\NormalTok{(}
\NormalTok{  ols, ols, ols,}
  \DataTypeTok{column.labels =} \KeywordTok{c}\NormalTok{(}\StringTok{"Truncated (truncreg)"}\NormalTok{, }\StringTok{"Truncated (nlm)"}\NormalTok{, }\StringTok{"OLS"}\NormalTok{),}
  \DataTypeTok{coef =} \KeywordTok{list}\NormalTok{(}\KeywordTok{coef}\NormalTok{(est.trunc), coef.LnLik[}\DecValTok{2}\OperatorTok{:}\DecValTok{6}\NormalTok{]),}
  \DataTypeTok{se =} \KeywordTok{list}\NormalTok{(se.trunc, se.LnLik[}\DecValTok{2}\OperatorTok{:}\DecValTok{6}\NormalTok{]),}
  \DataTypeTok{report =} \StringTok{"vcs"}\NormalTok{, }\DataTypeTok{keep.stat =} \KeywordTok{c}\NormalTok{(}\StringTok{"n"}\NormalTok{),}
  \DataTypeTok{covariate.labels =} \KeywordTok{c}\NormalTok{(}
    \StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{\#.Preschool Children"}\NormalTok{,}
    \StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{\#.School{-}aged Children"}\NormalTok{,}
    \StringTok{"Age"}\NormalTok{, }\StringTok{"Education Years"}
\NormalTok{  ),}
  \DataTypeTok{add.lines =} \KeywordTok{list}\NormalTok{(}
    \KeywordTok{c}\NormalTok{(}\StringTok{"Estimated Sigma"}\NormalTok{, }
      \KeywordTok{round}\NormalTok{(}\KeywordTok{coef}\NormalTok{(est.trunc)[}\DecValTok{6}\NormalTok{], }\DecValTok{3}\NormalTok{), }\KeywordTok{round}\NormalTok{(coef.LnLik[}\DecValTok{1}\NormalTok{], }\DecValTok{3}\NormalTok{)),}
    \KeywordTok{c}\NormalTok{(}\StringTok{"Log{-}Likelihood"}\NormalTok{, }
      \KeywordTok{round}\NormalTok{(est.trunc}\OperatorTok{$}\NormalTok{logLik, }\DecValTok{3}\NormalTok{), }\KeywordTok{round}\NormalTok{(}\OperatorTok{{-}}\NormalTok{est.LnLik}\OperatorTok{$}\NormalTok{minimum, }\DecValTok{3}\NormalTok{))}
\NormalTok{  ),}
  \DataTypeTok{omit.table.layout =} \StringTok{"n"}\NormalTok{, }\DataTypeTok{table.placement =} \StringTok{"t"}\NormalTok{,}
  \DataTypeTok{title =} \StringTok{"Truncated Regression: Labor Market Participation of Married Women"}\NormalTok{,}
  \DataTypeTok{label =} \StringTok{"lfp"}\NormalTok{,}
  \DataTypeTok{type =} \StringTok{"latex"}\NormalTok{, }\DataTypeTok{header =} \OtherTok{FALSE}  
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}[t] \centering 
  \caption{Truncated Regression: Labor Market Participation of Married Women} 
  \label{lfp} 
\begin{tabular}{@{\extracolsep{5pt}}lccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{3}{c}{\textit{Dependent variable:}} \\ 
\cline{2-4} 
\\[-1.8ex] & \multicolumn{3}{c}{whrs} \\ 
 & Truncated (truncreg) & Truncated (nlm) & OLS \\ 
\\[-1.8ex] & (1) & (2) & (3)\\ 
\hline \\[-1.8ex] 
 \#.Preschool Children & $-$456.785 & $-$803.032 & $-$421.482 \\ 
  & (266.367) & (252.803) & (167.973) \\ 
  & & & \\ 
 \#.School-aged Children & $-$153.347 & $-$172.875 & $-$104.457 \\ 
  & (81.780) & (100.590) & (54.186) \\ 
  & & & \\ 
 Age & $-$5.379 & $-$8.821 & $-$4.785 \\ 
  & (13.492) & (14.646) & (9.691) \\ 
  & & & \\ 
 Education Years & $-$0.092 & 16.529 & 9.353 \\ 
  & (43.702) & (46.430) & (31.238) \\ 
  & & & \\ 
 Constant & 1,624.584 & 1,586.228 & 1,629.817 \\ 
  & (857.730) & (932.878) & (615.130) \\ 
  & & & \\ 
\hline \\[-1.8ex] 
Estimated Sigma & 941.464 & 983.736 &  \\ 
Log-Likelihood & -1201.698 & -1200.916 &  \\ 
Observations & 150 & 150 & 150 \\ 
\hline 
\hline \\[-1.8ex] 
\end{tabular} 
\end{table}

\hypertarget{empirical-application-of-tobit-regression-labor-participation-of-married-women-2}{%
\section{Empirical Application of Tobit Regression: Labor Participation
of Married Women
(2)}\label{empirical-application-of-tobit-regression-labor-participation-of-married-women-2}}

\hypertarget{background-and-data-1}{%
\subsection{Background and Data}\label{background-and-data-1}}

We continue to investigate the previous research question. Our dataset
comes from Stata sample data, which is same as the previous dataset.
Unlike the previous dataset, we now observe married woment who do not
participate in the labor market. Additionally, we introduce the new
variable:

\begin{itemize}
\tightlist
\item
  \texttt{lfp}: a dummy variable taking 1 if observed unit works.
\end{itemize}

The previous dataset contains observations with \texttt{lfp\ =\ 1}. In
this application, we also use observations with \texttt{lfp\ =\ 0} to
estimate tobit model.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dt \textless{}{-}}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\DataTypeTok{file =} \StringTok{"./data/labor2.csv"}\NormalTok{, }\DataTypeTok{header =} \OtherTok{TRUE}\NormalTok{,  }\DataTypeTok{sep =} \StringTok{","}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(dt)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       lfp           whrs             kl6             k618             wa       
##  Min.   :0.0   Min.   :   0.0   Min.   :0.000   Min.   :0.000   Min.   :30.00  
##  1st Qu.:0.0   1st Qu.:   0.0   1st Qu.:0.000   1st Qu.:0.000   1st Qu.:35.00  
##  Median :1.0   Median : 406.5   Median :0.000   Median :1.000   Median :43.00  
##  Mean   :0.6   Mean   : 799.8   Mean   :0.236   Mean   :1.364   Mean   :42.92  
##  3rd Qu.:1.0   3rd Qu.:1599.8   3rd Qu.:0.000   3rd Qu.:2.000   3rd Qu.:49.00  
##  Max.   :1.0   Max.   :4950.0   Max.   :3.000   Max.   :8.000   Max.   :60.00  
##        we       
##  Min.   : 5.00  
##  1st Qu.:12.00  
##  Median :12.00  
##  Mean   :12.35  
##  3rd Qu.:13.00  
##  Max.   :17.00
\end{verbatim}

\hypertarget{model-1}{%
\subsection{Model}\label{model-1}}

Our dependent variable is censored from below at zero. This is because
married women chooses zero labor time if, without any constraint, the
optimal labor time is negative (corner solution). In this case, we
should use the tobit model. The tobit model is

\begin{equation*}
  y_i = 
  \begin{cases}
    \mathbf{x}_i \beta + u_i &\mathrm{if}\:\: y_i > a  \\
    a                        &\mathrm{otherwise}
  \end{cases},
\end{equation*} where \(E(u_i) = 0\) and \(\mathrm{Var}(u_i) = 0\). In
this application, we set \(a = 0\).

Using this model, the probability of \(y_i\) conditional on \(x_i\) is
defined by

\begin{equation*}
  p_{\beta, \sigma^2}(y_i | x_i) = \mathbb{P}(y_i \le 0)^{1[y_i = 0]} f(y_i | \mathbf{x}_i)^{1 - 1[y_i = 0]}
\end{equation*}

where \(f(y_i|x_i)\) is the probability density function conditional on
\(\mathbf{x}_i\), \(1[y_i = 0]\) is an indicator function returing 1 if
\(y_i = 0\). Now, we assume the distribution
\(u_i | \mathbf{x}_i \sim N(0, \sigma^2)\). Then, we can reformulate
\(\mathbb{P}(y_i \le 0)\) as follows:

\begin{equation*}
  \mathbb{P}(y_i \le 0) 
  = \mathbb{P}(-\mathbf{x}_i \beta \le u_i) 
  = \Phi \left( -\frac{\mathbf{x}_i \beta}{\sigma} \right)  
  = 1 - \Phi \left( \frac{\mathbf{x}_i \beta}{\sigma} \right),
\end{equation*} where \(\Phi(\cdot)\) is the cumulative distribution
function of the stadnard normal distribution. Note that the last
equatility comes from symmetric property of the standard normal
distribution. Moreover, the density function \(f\) is reformulated as
follows:

\begin{equation*}
  f(y_i | \mathbf{x}_i) = \frac{1}{\sigma} \phi \left( \frac{y_i - \mathbf{x}_i \beta}{\sigma} \right).
\end{equation*}

Assuming iid sample, we obtain the join probability function as follows:

\begin{equation*}
  p_{\beta, \sigma^2}((y_i | x_i), i = 1, \ldots, n) 
  = \prod_{i=1}^n \left(1 - \Phi \left( \frac{\mathbf{x}_i \beta}{\sigma} \right) \right)^{1[y_i = 0]} 
  \left( \frac{1}{\sigma} \phi \left( \frac{y_i - \mathbf{x}_i \beta}{\sigma} \right) \right)^{1 - 1[y_i = 0]}.
\end{equation*}

We estimate \(\log p_{\beta, \sigma^2}((y_i | x_i), i = 1, \ldots, n)\),
using the maximum likelihood method. In \texttt{R}, there are two ways
to implement the tobit regression. First way is to define the
log-likelihood function directly and minimize its function by
\texttt{nlm} function. We need to give intial values in argument of this
function. As intial values, coefficients of explanatory variables,
\texttt{b{[}3:6{]}}, are zero, and intercept, denoted by
\texttt{b{[}2{]}}, and \(\sigma\), denoted by \texttt{b{[}1{]}}, are
given by mean and standard deviation of \texttt{whrs}, respectively.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{whrs \textless{}{-}}\StringTok{ }\NormalTok{dt}\OperatorTok{$}\NormalTok{whrs}
\NormalTok{kl6 \textless{}{-}}\StringTok{ }\NormalTok{dt}\OperatorTok{$}\NormalTok{kl6; k618 \textless{}{-}}\StringTok{ }\NormalTok{dt}\OperatorTok{$}\NormalTok{k618}
\NormalTok{wa \textless{}{-}}\StringTok{ }\NormalTok{dt}\OperatorTok{$}\NormalTok{wa; we \textless{}{-}}\StringTok{ }\NormalTok{dt}\OperatorTok{$}\NormalTok{we}

\NormalTok{LnLik \textless{}{-}}\StringTok{ }\ControlFlowTok{function}\NormalTok{(b) \{}
\NormalTok{  sigma \textless{}{-}}\StringTok{ }\NormalTok{b[}\DecValTok{1}\NormalTok{]}
\NormalTok{  xb \textless{}{-}}\StringTok{ }\NormalTok{b[}\DecValTok{2}\NormalTok{] }\OperatorTok{+}\StringTok{ }\NormalTok{b[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{kl6 }\OperatorTok{+}\StringTok{ }\NormalTok{b[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{k618 }\OperatorTok{+}\StringTok{ }\NormalTok{b[}\DecValTok{5}\NormalTok{]}\OperatorTok{*}\NormalTok{wa }\OperatorTok{+}\StringTok{ }\NormalTok{b[}\DecValTok{6}\NormalTok{]}\OperatorTok{*}\NormalTok{we}
\NormalTok{  Ia \textless{}{-}}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(whrs }\OperatorTok{==}\StringTok{ }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\NormalTok{  F0 \textless{}{-}}\StringTok{ }\DecValTok{1} \OperatorTok{{-}}\StringTok{ }\KeywordTok{pnorm}\NormalTok{(xb}\OperatorTok{/}\NormalTok{sigma)}
\NormalTok{  fa \textless{}{-}}\StringTok{ }\KeywordTok{dnorm}\NormalTok{((whrs }\OperatorTok{{-}}\StringTok{ }\NormalTok{xb)}\OperatorTok{/}\NormalTok{sigma)}\OperatorTok{/}\NormalTok{sigma}
\NormalTok{  LL\_i \textless{}{-}}\StringTok{ }\NormalTok{Ia }\OperatorTok{*}\StringTok{ }\KeywordTok{log}\NormalTok{(F0) }\OperatorTok{+}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{{-}}\StringTok{ }\NormalTok{Ia) }\OperatorTok{*}\StringTok{ }\KeywordTok{log}\NormalTok{(fa)}
\NormalTok{  LL \textless{}{-}}\StringTok{ }\OperatorTok{{-}}\KeywordTok{sum}\NormalTok{(LL\_i)}
  \KeywordTok{return}\NormalTok{(LL)}
\NormalTok{\}}

\NormalTok{init \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{sd}\NormalTok{(whrs), }\KeywordTok{mean}\NormalTok{(whrs), }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\NormalTok{est.LnLik \textless{}{-}}\StringTok{ }\KeywordTok{nlm}\NormalTok{(LnLik, init, }\DataTypeTok{hessian =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{coef.tobitNLM \textless{}{-}}\StringTok{ }\NormalTok{est.LnLik}\OperatorTok{$}\NormalTok{estimate}
\NormalTok{se.tobitNLM \textless{}{-}}\StringTok{ }\KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\KeywordTok{solve}\NormalTok{(est.LnLik}\OperatorTok{$}\NormalTok{hessian)))}
\end{Highlighting}
\end{Shaded}

Second way is to use the function \texttt{vglm} in the library
\texttt{VGAM}. First, we need to declare the tobit distribution
(\texttt{tobit}), using the \texttt{family} augment. The \texttt{tobit}
function needs the censored point (the value of \(a\)) in arguments
\texttt{Lower} and \texttt{Upper}. When you specify \texttt{Lower}, the
observed outcome is left-censored. On the other hand, when you specify
\texttt{Upper}, the observed outcome is right-censored. In this
application, we set \texttt{Lower\ =\ 0}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(VGAM)}
\NormalTok{tobitVGAM \textless{}{-}}\StringTok{ }\KeywordTok{vglm}\NormalTok{(whrs }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{kl6 }\OperatorTok{+}\StringTok{ }\NormalTok{k618 }\OperatorTok{+}\StringTok{ }\NormalTok{wa }\OperatorTok{+}\StringTok{ }\NormalTok{we, }\DataTypeTok{family =} \KeywordTok{tobit}\NormalTok{(}\DataTypeTok{Lower =} \DecValTok{0}\NormalTok{), }\DataTypeTok{data =}\NormalTok{ dt)}
\NormalTok{coef.tobitVGAM \textless{}{-}}\StringTok{ }\KeywordTok{coef}\NormalTok{(tobitVGAM)}
\NormalTok{coef.tobitVGAM[}\DecValTok{2}\NormalTok{] \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(coef.tobitVGAM[}\DecValTok{2}\NormalTok{])}
\NormalTok{se.tobitVGAM \textless{}{-}}\StringTok{ }\KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\KeywordTok{vcov}\NormalTok{(tobitVGAM)))[}\OperatorTok{{-}}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\hypertarget{interpretations-1}{%
\subsection{Interpretations}\label{interpretations-1}}

Table \ref{lfp_tobit} shows results of tobit regression estimated by two
methods. As a comparison, we also show the OLS result in column (3).
Althourgh all specifications show the same sign of coefficients, size of
coefficients of censored regression becomes stronger than of OLS. For
example, the number of preschool and school-aged children reduces the
hours of work. The size of coefficient of the number of preschool and
school-aged children become stronger when we apply the censored
regression.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ols \textless{}{-}}\StringTok{ }\KeywordTok{lm}\NormalTok{(whrs }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{kl6 }\OperatorTok{+}\StringTok{ }\NormalTok{k618 }\OperatorTok{+}\StringTok{ }\NormalTok{wa }\OperatorTok{+}\StringTok{ }\NormalTok{we, }\DataTypeTok{data =}\NormalTok{dt)}
\KeywordTok{names}\NormalTok{(coef.tobitNLM) \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"sigma"}\NormalTok{, }\KeywordTok{names}\NormalTok{(}\KeywordTok{coef}\NormalTok{(ols)))}
\KeywordTok{names}\NormalTok{(se.tobitNLM) \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"sigma"}\NormalTok{, }\KeywordTok{names}\NormalTok{(}\KeywordTok{coef}\NormalTok{(ols)))}
\KeywordTok{names}\NormalTok{(coef.tobitVGAM) \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{names}\NormalTok{(}\KeywordTok{coef}\NormalTok{(ols))[}\DecValTok{1}\NormalTok{], }\StringTok{"sigma"}\NormalTok{, }\KeywordTok{names}\NormalTok{(}\KeywordTok{coef}\NormalTok{(ols))[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])}
\KeywordTok{names}\NormalTok{(se.tobitVGAM) \textless{}{-}}\StringTok{ }\KeywordTok{names}\NormalTok{(}\KeywordTok{coef}\NormalTok{(ols))}

\KeywordTok{stargazer}\NormalTok{(}
\NormalTok{  ols, ols, ols,}
  \DataTypeTok{column.labels =} \KeywordTok{c}\NormalTok{(}\StringTok{"Tobit (vglm)"}\NormalTok{, }\StringTok{"Tobit (nlm)"}\NormalTok{, }\StringTok{"OLS"}\NormalTok{),}
  \DataTypeTok{coef =} \KeywordTok{list}\NormalTok{(coef.tobitVGAM[}\OperatorTok{{-}}\DecValTok{2}\NormalTok{], coef.tobitNLM[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]),}
  \DataTypeTok{se =} \KeywordTok{list}\NormalTok{(se.tobitVGAM, se.tobitNLM[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]),}
  \DataTypeTok{report =} \StringTok{"vcs"}\NormalTok{, }\DataTypeTok{keep.stat =} \KeywordTok{c}\NormalTok{(}\StringTok{"n"}\NormalTok{),}
  \DataTypeTok{covariate.labels =} \KeywordTok{c}\NormalTok{(}
    \StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{\#.Preschool Children"}\NormalTok{,}
    \StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{\#.School{-}aged Children"}\NormalTok{,}
    \StringTok{"Age"}\NormalTok{, }\StringTok{"Education Years"}
\NormalTok{  ),}
  \DataTypeTok{add.lines =} \KeywordTok{list}\NormalTok{(}
    \KeywordTok{c}\NormalTok{(}\StringTok{"Estimated Sigma"}\NormalTok{, }
      \KeywordTok{round}\NormalTok{(coef.tobitVGAM[}\DecValTok{2}\NormalTok{], }\DecValTok{3}\NormalTok{), }\KeywordTok{round}\NormalTok{(coef.tobitNLM[}\DecValTok{1}\NormalTok{], }\DecValTok{3}\NormalTok{)),}
    \KeywordTok{c}\NormalTok{(}\StringTok{"Log{-}Likelihood"}\NormalTok{, }
      \KeywordTok{round}\NormalTok{(}\KeywordTok{logLik}\NormalTok{(tobitVGAM), }\DecValTok{3}\NormalTok{), }\KeywordTok{round}\NormalTok{(}\OperatorTok{{-}}\NormalTok{est.LnLik}\OperatorTok{$}\NormalTok{minimum, }\DecValTok{3}\NormalTok{))}
\NormalTok{  ),}
  \DataTypeTok{omit.table.layout =} \StringTok{"n"}\NormalTok{, }\DataTypeTok{table.placement =} \StringTok{"t"}\NormalTok{,}
  \DataTypeTok{title =} \StringTok{"Tobit Regression: Labor Market Participation of Married Women"}\NormalTok{,}
  \DataTypeTok{label =} \StringTok{"lfp\_tobit"}\NormalTok{,}
  \DataTypeTok{type =} \StringTok{"latex"}\NormalTok{, }\DataTypeTok{header =} \OtherTok{FALSE}  
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}[t] \centering 
  \caption{Tobit Regression: Labor Market Participation of Married Women} 
  \label{lfp_tobit} 
\begin{tabular}{@{\extracolsep{5pt}}lccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{3}{c}{\textit{Dependent variable:}} \\ 
\cline{2-4} 
\\[-1.8ex] & \multicolumn{3}{c}{whrs} \\ 
 & Tobit (vglm) & Tobit (nlm) & OLS \\ 
\\[-1.8ex] & (1) & (2) & (3)\\ 
\hline \\[-1.8ex] 
 \#.Preschool Children & $-$827.768 & $-$827.733 & $-$462.123 \\ 
  & (218.507) & (171.275) & (124.677) \\ 
  & & & \\ 
 \#.School-aged Children & $-$140.017 & $-$140.004 & $-$91.141 \\ 
  & (75.203) & (69.379) & (45.850) \\ 
  & & & \\ 
 Age & $-$24.980 & $-$24.973 & $-$13.158 \\ 
  & (13.217) & (12.528) & (8.335) \\ 
  & & & \\ 
 Education Years & 103.694 & 103.707 & 53.262 \\ 
  & (41.433) & (41.780) & (26.094) \\ 
  & & & \\ 
 Constant & 588.961 & 588.488 & 940.059 \\ 
  & (838.808) & (812.625) & (530.720) \\ 
  & & & \\ 
\hline \\[-1.8ex] 
Estimated Sigma & 1309.928 & 1309.914 &  \\ 
Log-Likelihood & -1367.09 & -1367.09 &  \\ 
Observations & 250 & 250 & 250 \\ 
\hline 
\hline \\[-1.8ex] 
\end{tabular} 
\end{table}

\hypertarget{empirical-application-of-poisson-regression-demand-of-recreation}{%
\section{Empirical Application of Poisson Regression: Demand of
Recreation}\label{empirical-application-of-poisson-regression-demand-of-recreation}}

\hypertarget{background-and-data-2}{%
\subsection{Background and Data}\label{background-and-data-2}}

The Poisson distribution is used for drawing purchasing behavior.
Especially, the parameter \(\lambda\) means that preference for goods
because the expectation of frequency of purchasing, E(X), is equal to
\(\lambda\) (we omit proof here). For example, Tsuyoshi Morioka, a
famous marketer contributing the v-shaped recovery of Universal Studio
Japan, insists that marketers try to increase the parameter \(\lambda\).

In this application, using cross-section data about recreational boating
trips to Lake Somerville, Texas, in 1980, we investigates who has a high
preference for this area. We use the built-in dataset called
\texttt{RecreationDemand} in the library \texttt{AER}. This dataset is
based on a survey administered to 2,000 registered leisure boat owners
in 23 counties in eastern Texas. We use following four variables:

\begin{itemize}
\tightlist
\item
  \texttt{trips}: Number of recreational boating trips.
\item
  \texttt{income}: Annual household income of the respondent (in 1,000
  USD).
\item
  \texttt{ski}: Dummy variable taking 1 if the individual was engaged in
  water-skiing at the lake
\item
  \texttt{userfee}: Dummy variable taking 1 if the individual payed an
  annual user fee at Lake Somerville?
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(AER)}
\KeywordTok{data}\NormalTok{(}\StringTok{"RecreationDemand"}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(RecreationDemand)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      trips           quality       ski          income      userfee  
##  Min.   : 0.000   Min.   :0.000   no :417   Min.   :1.000   no :646  
##  1st Qu.: 0.000   1st Qu.:0.000   yes:242   1st Qu.:3.000   yes: 13  
##  Median : 0.000   Median :0.000             Median :3.000            
##  Mean   : 2.244   Mean   :1.419             Mean   :3.853            
##  3rd Qu.: 2.000   3rd Qu.:3.000             3rd Qu.:5.000            
##  Max.   :88.000   Max.   :5.000             Max.   :9.000            
##      costC            costS             costH       
##  Min.   :  4.34   Min.   :  4.767   Min.   :  5.70  
##  1st Qu.: 28.24   1st Qu.: 33.312   1st Qu.: 28.96  
##  Median : 41.19   Median : 47.000   Median : 42.38  
##  Mean   : 55.42   Mean   : 59.928   Mean   : 55.99  
##  3rd Qu.: 69.67   3rd Qu.: 72.573   3rd Qu.: 68.56  
##  Max.   :493.77   Max.   :491.547   Max.   :491.05
\end{verbatim}

\hypertarget{model-2}{%
\subsection{Model}\label{model-2}}

Let \(y_i\) be the number of recreational boating trips. We assume that
this variable follows the Poisson distribution conditional co covariates
\(\mathbf{x}_i\). That is,

\begin{equation*}
  p_{\beta}(y_i | \mathbf{x}_i) = \frac{\exp(-\lambda_i) \lambda_i^{y_i}}{y_i !},
\end{equation*} where \(\lambda_i = \exp(\mathbf{x}_i \beta)\).
Importantly, \(\lambda_i\) represents the preference for boating trips
because

\begin{equation*}
  E[y_i | \mathbf{x}_i] = \lambda_i = \exp(\mathbf{x}_i \beta).
\end{equation*}

Assuming iid sample, the joint density function is defined by

\begin{equation*}
  p_{\beta}((y_i|\mathbf{x}_i), i = 1, \ldots, n) = \prod_{i=1}^n \frac{\exp(-\lambda_i) \lambda_i^{y_i}}{y_i !}.
\end{equation*} Thus, the log-likelihood function is

\begin{equation*}
  M_n(\beta) 
  = \sum_{i=1}^n (-\lambda_i + y_i \log \lambda_i - \log y_i !)  
  = \sum_{i=1}^n (- \exp(\mathbf{x}_i \beta) + y_i \mathbf{x}_i \beta - \log y_i !).
\end{equation*}

Since the first-order condition (orthogonality condition) is non-linear
with respect to \(\beta\), we apply the Newton-Raphson method to obtain
MLE. In \texttt{R}, there are two way to implement the Poisson
regression. First way is to define the log-likelihood function directly
and minimize its function by \texttt{nlm} function. We need to give
intial values in argument of this function. As intial values,
coefficients of explanatory variables, \texttt{b{[}2:4{]}}, are zero,
and intercept, denoted by \texttt{b{[}2{]}}, are given by mean of
\texttt{trips}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{trips \textless{}{-}}\StringTok{ }\NormalTok{RecreationDemand}\OperatorTok{$}\NormalTok{trips; income \textless{}{-}}\StringTok{ }\NormalTok{RecreationDemand}\OperatorTok{$}\NormalTok{income}
\NormalTok{ski \textless{}{-}}\StringTok{ }\KeywordTok{as.integer}\NormalTok{(RecreationDemand}\OperatorTok{$}\NormalTok{ski) }\OperatorTok{{-}}\StringTok{ }\DecValTok{1} 
\NormalTok{userfee \textless{}{-}}\StringTok{ }\KeywordTok{as.integer}\NormalTok{(RecreationDemand}\OperatorTok{$}\NormalTok{userfee) }\OperatorTok{{-}}\StringTok{ }\DecValTok{1}

\NormalTok{LnLik \textless{}{-}}\StringTok{ }\ControlFlowTok{function}\NormalTok{(b) \{}
\NormalTok{  xb \textless{}{-}}\StringTok{ }\NormalTok{b[}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\StringTok{ }\NormalTok{b[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{income }\OperatorTok{+}\StringTok{ }\NormalTok{b[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{ski }\OperatorTok{+}\StringTok{ }\NormalTok{b[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{userfee}
\NormalTok{  LL\_i \textless{}{-}}\StringTok{ }\OperatorTok{{-}}\KeywordTok{exp}\NormalTok{(xb) }\OperatorTok{+}\StringTok{ }\NormalTok{trips}\OperatorTok{*}\NormalTok{xb }\OperatorTok{{-}}\StringTok{ }\KeywordTok{log}\NormalTok{(}\KeywordTok{gamma}\NormalTok{(trips}\OperatorTok{+}\DecValTok{1}\NormalTok{))}
\NormalTok{  LL \textless{}{-}}\StringTok{ }\OperatorTok{{-}}\KeywordTok{sum}\NormalTok{(LL\_i)}
  \KeywordTok{return}\NormalTok{(LL)}
\NormalTok{\}}

\NormalTok{init \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{mean}\NormalTok{(trips), }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\NormalTok{poissonMLE \textless{}{-}}\StringTok{ }\KeywordTok{nlm}\NormalTok{(LnLik, init, }\DataTypeTok{hessian =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{coef.poissonMLE \textless{}{-}}\StringTok{ }\NormalTok{poissonMLE}\OperatorTok{$}\NormalTok{estimate}
\NormalTok{se.poissonMLE \textless{}{-}}\StringTok{ }\KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\KeywordTok{solve}\NormalTok{(poissonMLE}\OperatorTok{$}\NormalTok{hessian)))}
\NormalTok{logLik.poissonMLE \textless{}{-}}\StringTok{ }\OperatorTok{{-}}\NormalTok{poissonMLE}\OperatorTok{$}\NormalTok{minimum}
\end{Highlighting}
\end{Shaded}

The second way is to use \texttt{glm} function. To implement this
function, we need to specify the Poisson distribution,
\texttt{poisson()} in the \texttt{family} augment. We can obtain the
value of log-likelihood function, using the \texttt{logLik} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model \textless{}{-}}\StringTok{ }\NormalTok{trips }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{income }\OperatorTok{+}\StringTok{ }\NormalTok{ski }\OperatorTok{+}\StringTok{ }\NormalTok{userfee}
\NormalTok{poissonGLM \textless{}{-}}\StringTok{ }\KeywordTok{glm}\NormalTok{(model, }\DataTypeTok{family =} \KeywordTok{poisson}\NormalTok{(), }\DataTypeTok{data =}\NormalTok{ RecreationDemand)}
\NormalTok{logLik.poissonGLM \textless{}{-}}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{logLik}\NormalTok{(poissonGLM))}
\end{Highlighting}
\end{Shaded}

\hypertarget{interpretations-2}{%
\subsection{Interpretations}\label{interpretations-2}}

Table \ref{recreation} shows results of the Poisson regression estimated
by two methods, \texttt{nlm} and \texttt{glm}. As a comparison, we also
show the result of OLS estimation. Clearly, the \texttt{nlm} methods
(column 1) returns quite similar results to the \texttt{glm} method
(column 2). Alotough the size of coeffcients of OLSE is farther away
from zero than coefficients of the Poisson regression, the sign of
coeffcients of OLSE is same as coefficients of the Poisson regression.
Surprisingly, we obtain the negative relationship between annual income
and preference for boating trips. This implies that high-earners are
less likely to go to Lake Somerville.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{names}\NormalTok{(coef.poissonMLE) \textless{}{-}}\StringTok{ }\KeywordTok{names}\NormalTok{(}\KeywordTok{coef}\NormalTok{(poissonGLM))}
\KeywordTok{names}\NormalTok{(se.poissonMLE) \textless{}{-}}\StringTok{ }\KeywordTok{names}\NormalTok{(}\KeywordTok{coef}\NormalTok{(poissonGLM))}
\NormalTok{ols \textless{}{-}}\StringTok{ }\KeywordTok{lm}\NormalTok{(model, }\DataTypeTok{data =}\NormalTok{ RecreationDemand)}

\KeywordTok{stargazer}\NormalTok{(}
\NormalTok{  poissonGLM, poissonGLM, ols,}
  \DataTypeTok{coef =} \KeywordTok{list}\NormalTok{(coef.poissonMLE),}
  \DataTypeTok{se =} \KeywordTok{list}\NormalTok{(se.poissonMLE),}
  \DataTypeTok{report =} \StringTok{"vcs"}\NormalTok{, }\DataTypeTok{keep.stat =} \KeywordTok{c}\NormalTok{(}\StringTok{"n"}\NormalTok{),}
  \DataTypeTok{covariate.labels =} \KeywordTok{c}\NormalTok{(}
    \StringTok{"Income"}\NormalTok{,}
    \StringTok{"1 = Playing water{-}skiing"}\NormalTok{,}
    \StringTok{"1 = Paying annual fee"}
\NormalTok{  ),}
  \DataTypeTok{add.lines =} \KeywordTok{list}\NormalTok{(}
    \KeywordTok{c}\NormalTok{(}\StringTok{"Method"}\NormalTok{, }\StringTok{"nlm"}\NormalTok{, }\StringTok{"glm"}\NormalTok{, }\StringTok{""}\NormalTok{),}
    \KeywordTok{c}\NormalTok{(}\StringTok{"Log{-}Likelihood"}\NormalTok{, }
      \KeywordTok{round}\NormalTok{(logLik.poissonMLE, }\DecValTok{3}\NormalTok{), }\KeywordTok{round}\NormalTok{(logLik.poissonGLM, }\DecValTok{3}\NormalTok{), }\StringTok{""}\NormalTok{)}
\NormalTok{  ),}
  \DataTypeTok{omit.table.layout =} \StringTok{"n"}\NormalTok{, }\DataTypeTok{table.placement =} \StringTok{"t"}\NormalTok{,}
  \DataTypeTok{title =} \StringTok{"Poisson Regression: Recreation Demand"}\NormalTok{,}
  \DataTypeTok{label =} \StringTok{"recreation"}\NormalTok{, }
  \DataTypeTok{type =} \StringTok{"latex"}\NormalTok{, }\DataTypeTok{header =} \OtherTok{FALSE}  
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}[t] \centering 
  \caption{Poisson Regression: Recreation Demand} 
  \label{recreation} 
\begin{tabular}{@{\extracolsep{5pt}}lccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{3}{c}{\textit{Dependent variable:}} \\ 
\cline{2-4} 
\\[-1.8ex] & \multicolumn{3}{c}{trips} \\ 
\\[-1.8ex] & \multicolumn{2}{c}{\textit{Poisson}} & \textit{OLS} \\ 
\\[-1.8ex] & (1) & (2) & (3)\\ 
\hline \\[-1.8ex] 
 Income & $-$0.146 & $-$0.146 & $-$0.277 \\ 
  & (0.017) & (0.017) & (0.133) \\ 
  & & & \\ 
 1 = Playing water-skiing & 0.547 & 0.547 & 1.243 \\ 
  & (0.055) & (0.055) & (0.509) \\ 
  & & & \\ 
 1 = Paying annual fee & 1.904 & 1.904 & 12.412 \\ 
  & (0.078) & (0.078) & (1.688) \\ 
  & & & \\ 
 Constant & 1.006 & 1.006 & 2.609 \\ 
  & (0.065) & (0.065) & (0.545) \\ 
  & & & \\ 
\hline \\[-1.8ex] 
Method & nlm & glm &  \\ 
Log-Likelihood & -2529.256 & -2529.256 &  \\ 
Observations & 659 & 659 & 659 \\ 
\hline 
\hline \\[-1.8ex] 
\end{tabular} 
\end{table}

\end{document}
